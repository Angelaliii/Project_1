use rent_classroom;
CREATE TABLE users (
user_id INT AUTO_INCREMENT PRIMARY KEY,
user_name VARCHAR(255) NOT NULL UNIQUE,
mail VARCHAR(255) NOT NULL UNIQUE,
password VARCHAR(255) NOT NULL,
role ENUM('student', 'teacher', 'admin') NOT NULL,
created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
) ;

CREATE TABLE classrooms (
classroom_ID INT AUTO_INCREMENT PRIMARY KEY,
classroom_name VARCHAR(255) NOT NULL,
building VARCHAR(255),
room VARCHAR(255),
picture Blob,
created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);

CREATE TABLE bookings (
booking_ID INT AUTO_INCREMENT PRIMARY KEY,
classroom_ID INT NOT NULL,
user_ID INT NOT NULL,
status ENUM('available', 'booked', 'in_use', 'completed', 'cancelled') NOT NULL DEFAULT 'available',
start_datetime DATETIME NOT NULL,
end_datetime DATETIME NOT NULL,
created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
FOREIGN KEY (classroom_ID) REFERENCES classrooms(classroom_ID) ON DELETE CASCADE ON UPDATE CASCADE,
FOREIGN KEY (user_ID) REFERENCES users(user_id) ON DELETE CASCADE ON UPDATE CASCADE,
INDEX idx_classroom_start_end (classroom_ID, start_datetime, end_datetime)
);

CREATE TABLE booking_slots (
slot_ID INT AUTO_INCREMENT PRIMARY KEY,
booking_ID INT NOT NULL,
date DATE NOT NULL,
hour TINYINT UNSIGNED NOT NULL,
created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
FOREIGN KEY (booking_ID) REFERENCES bookings(booking_ID) ON DELETE CASCADE ON UPDATE CASCADE
);
